{"version":3,"sources":["services/api-clients.js","components/ListItems/Video.jsx","utililits/debounce.js","utililits/getvalidUrl.js","components/Spinner/index.js","components/Spinner/spinner.js","components/ListItems/index.js","components/ListItems/ListItems.jsx","components/Navbar/index.js","components/Navbar/Navbar.jsx","index.js"],"names":["ApiClient","_apiBase","_nextPosts","mediaFilter","postArray","filter","post","data","is_reddit_media_domain","next","fetch","concat","this","res","ok","Error","status","json","responseJSON","after","allPosts","children","mediaPost","Singleton","instance","makeClient","Video","props","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","hasError","visible","_this2","video","play","window","addEventListener","pause","nextProps","setState","isVisible","error","info","_this3","react_default","a","createElement","className","ref","node","controls","name","style","maxHeight","src","type","Component","debounce","f","ms","isCooldown","apply","arguments","setTimeout","getValidVideoUrl","str","cutBefore","indexOf","slice","Spinner","ListItems","showFavorites","loading","array2","favorites","addPosts","getResource","then","val","prevState","toConsumableArray","document","documentElement","clientHeight","Math","floor","getBoundingClientRect","bottom","elements","postsArray","map","_ref","is_video","created","url","title","id","author_fullname","author","uniqKey","videoUrl","media","reddit_video","fallback_url","alreadyInFav","some","unikId","key","minHeigth","maxHeigth","lib_default","Video_Video","react_medium_image_zoom_lib_default","image","alt","width","zoomImage","href","onClick","e","preventDefault","favPost","_objectSpread","removeFavPost","components_Spinner","Navbar","height","rootElement","getElementById","ReactDOM","render","components_Navbar","react_router_dom","react_router","path","exact","component"],"mappings":"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","file":"static/js/main.21f74141.chunk.js","sourcesContent":["class ApiClient {\r\n  _apiBase = \"https://www.reddit.com/r/cats.json?\";\r\n  _nextPosts = \"\";\r\n\r\n  mediaFilter = postArray => {\r\n    return postArray.filter(post => post.data.is_reddit_media_domain);\r\n  };\r\n\r\n  /* метод getResource делает запрос и получает видио или фото посты\r\n   * @next - аргумент boolean. true - запрос для получения следующих постов(infiniteScroll)\r\n   */\r\n  async getResource(next) {\r\n    const res = next\r\n      ? await fetch(`${this._apiBase}after=${this._nextPosts}`)\r\n      : await fetch(`${this._apiBase}limit=25`);\r\n\r\n    if (!res.ok) {\r\n      throw new Error(\r\n        `Could not fetch ${this._apiBase}, received ${res.status}`\r\n      );\r\n    }\r\n\r\n    const responseJSON = await res.json();\r\n    this._nextPosts = responseJSON.data.after;\r\n    const allPosts = [...responseJSON.data.children];\r\n    const mediaPost = this.mediaFilter(allPosts);\r\n\r\n    return mediaPost;\r\n  }\r\n}\r\n\r\nconst Singleton = (function() {\r\n  var instance;\r\n\r\n  const createInstance = () => {\r\n    return new ApiClient();\r\n  };\r\n\r\n  return {\r\n    makeClient: function() {\r\n      if (!instance) {\r\n        instance = createInstance();\r\n      }\r\n      return instance;\r\n    }\r\n  };\r\n})();\r\n\r\nexport default Singleton;\r\n","import React, { Component } from \"react\";\r\n\r\nexport default class Video extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      visible: true\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.video.play();\r\n    window.addEventListener(\"scroll\", () => {\r\n      if (this.video) {\r\n        this.state.visible ? this.video.play() : this.video.pause();\r\n      }\r\n    });\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.setState({ visible: nextProps.isVisible });\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({\r\n      hasError: true\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return this.state.hasError ? (\r\n      <h1 className=\"mt-5 text-center\">Что-то пошло не так</h1>\r\n    ) : (\r\n      <video\r\n        ref={node => {\r\n          this.video = node;\r\n        }}\r\n        controls\r\n        className=\"pt-4\"\r\n        name=\"media\"\r\n        style={{ maxHeight: \"80vh\" }}\r\n      >\r\n        <source src={this.props.src} type=\"video/mp4\" />\r\n      </video>\r\n    );\r\n  }\r\n}\r\n","const debounce = (f, ms) => {\r\n  let isCooldown = false;\r\n\r\n  return function() {\r\n    if (isCooldown) return;\r\n\r\n    f.apply(this, arguments);\r\n\r\n    isCooldown = true;\r\n\r\n    setTimeout(() => (isCooldown = false), ms);\r\n  };\r\n};\r\n\r\nexport default debounce;\r\n","const getValidVideoUrl = str => {\r\n  const cutBefore = str.indexOf(\"?\");\r\n  const validUrl = str.slice(0, cutBefore);\r\n  return validUrl;\r\n};\r\n\r\nexport default getValidVideoUrl;\r\n","import Spinner from './spinner';\r\n\r\nexport default Spinner;\r\n","import React from \"react\";\r\n\r\nimport \"./spinner.css\";\r\n\r\nconst Spinner = () => {\r\n  return (\r\n    <div className=\"main-container\">\r\n      <div className=\"lds-css\">\r\n        <div className=\"lds-double-ring\">\r\n          <div />\r\n          <div />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","import ListItems from \"./ListItems\";\r\n\r\nexport default ListItems;\r\n","import React, { Component } from \"react\";\r\nimport Singleton from \"../../services/api-clients\";\r\nimport TrackVisibility from \"react-on-screen\";\r\nimport ImageZoom from \"react-medium-image-zoom\";\r\nimport Video from \"./Video\";\r\nimport debounce from \"../../utililits/debounce\";\r\nimport getValidVideoUrl from \"../../utililits/getvalidUrl\";\r\nimport Spinner from \"../Spinner\";\r\n\r\nimport \"./ListItems.css\";\r\n\r\nexport default class ListItems extends Component {\r\n  state = {\r\n    showFavorites: false,\r\n    hasError: false,\r\n    loading: true,\r\n    array2: [],\r\n    favorites: []\r\n  };\r\n  componentDidMount() {\r\n    const apiClient = Singleton.makeClient();\r\n\r\n    apiClient\r\n      .getResource()\r\n      .then(val => this.setState({ loading: false, array2: val }));\r\n\r\n    window.addEventListener(\"scroll\", () => {\r\n      const clientHeight = document.documentElement.clientHeight + 1;\r\n      const scrollEnd = Math.floor(\r\n        document.documentElement.getBoundingClientRect().bottom\r\n      );\r\n\r\n      if (clientHeight >= scrollEnd && !this.state.showFavorites) {\r\n        debounce(this.addPosts, 1000)();\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({\r\n      hasError: true\r\n    });\r\n  }\r\n\r\n  addPosts = () => {\r\n    this.setState({ loading: true });\r\n    const getNextPosts = Singleton.makeClient();\r\n\r\n    getNextPosts.getResource(true).then(val =>\r\n      this.setState(\r\n        prevState => {\r\n          return { array2: [...prevState.array2, ...val] };\r\n        },\r\n        () => {\r\n          this.setState({ loading: false });\r\n        }\r\n      )\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const elements = postsArray =>\r\n      postsArray.map(({ data }) => {\r\n        const {\r\n          is_video,\r\n          created,\r\n          url,\r\n          title,\r\n          id,\r\n          author_fullname,\r\n          author\r\n        } = data;\r\n\r\n        const uniqKey = `${created}${id}${author_fullname}`;\r\n        const videoUrl = is_video && data.media.reddit_video.fallback_url;\r\n        let alreadyInFav = this.state.favorites.some(val => {\r\n          return val.data.unikId === uniqKey;\r\n        });\r\n\r\n        return (\r\n          <div\r\n            className=\"card col-md-5 mt-5 py-3\"\r\n            key={uniqKey}\r\n            style={{ minHeigth: \"75vh\", maxHeigth: \"75vh\" }}\r\n          >\r\n            <div className=\"text-muted small pt-4\">{`Posted by ${author}`}</div>\r\n            {is_video ? (\r\n              <TrackVisibility>\r\n                <Video src={getValidVideoUrl(videoUrl)} />\r\n              </TrackVisibility>\r\n            ) : (\r\n              <ImageZoom\r\n                image={{\r\n                  src: `${url}`,\r\n                  alt: `${title}`,\r\n                  className: \"card-img-top m-auto pt-4\",\r\n                  style: { width: \"21vw\", maxHeight: \"73vh\" }\r\n                }}\r\n                zoomImage={{\r\n                  src: \"bridge-big.jpg\",\r\n                  alt: \"Golden Gate Bridge\"\r\n                }}\r\n              />\r\n            )}\r\n            <div className=\"card-body\">\r\n              <p className=\"card-text\">{title}</p>\r\n              <a\r\n                href=\"#2\"\r\n                onClick={e => {\r\n                  e.preventDefault();\r\n                  const favPost = {\r\n                    data: { ...data, unikId: uniqKey }\r\n                  };\r\n\r\n                  if (alreadyInFav) {\r\n                    const removeFavPost = this.state.favorites.filter(val => {\r\n                      return val.data.unikId !== uniqKey;\r\n                    });\r\n\r\n                    return this.setState({ favorites: removeFavPost });\r\n                  }\r\n\r\n                  this.setState(prevState => {\r\n                    return {\r\n                      favorites: [...prevState.favorites, favPost]\r\n                    };\r\n                  });\r\n                }}\r\n              >\r\n                <img\r\n                  src={\r\n                    alreadyInFav\r\n                      ? \"https://image.flaticon.com/icons/png/512/69/69450.png\"\r\n                      : \"https://image.flaticon.com/icons/png/512/25/25424.png\"\r\n                  }\r\n                  alt=\"heart icon\"\r\n                  width=\"20px\"\r\n                />\r\n              </a>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    return this.state.hasError ? (\r\n      <h1 className=\"mt-5 text-center\">Что-то пошло не так</h1>\r\n    ) : (\r\n      <div className=\"text-center d-flex flex-column align-items-center\">\r\n        {this.state.loading ? <Spinner /> : null}\r\n        {this.state.showFavorites\r\n          ? elements(this.state.favorites)\r\n          : elements(this.state.array2)}\r\n        <a\r\n          href=\"#favorites\"\r\n          className=\"favorites\"\r\n          onClick={e => {\r\n            e.preventDefault();\r\n            this.setState(prevState => {\r\n              return { showFavorites: !prevState.showFavorites };\r\n            });\r\n          }}\r\n        >\r\n          <img\r\n            src={\r\n              !this.state.showFavorites\r\n                ? \"https://image.flaticon.com/icons/png/512/69/69450.png\"\r\n                : \"https://image.flaticon.com/icons/png/512/25/25424.png\"\r\n            }\r\n            alt=\"To the favorite/To the all\"\r\n            width=\"20px\"\r\n            title=\"show favorites\"\r\n          />\r\n        </a>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Navbar from \"./Navbar\";\r\n\r\nexport default Navbar;\r\n","import React from \"react\";\r\n\r\nconst Navbar = () => {\r\n  return (\r\n    <nav className=\"navbar navbar-light bg-warning\">\r\n      <a className=\"navbar-brand h1\" href=\"#1\">\r\n        <img\r\n          src=\"https://upload.wikimedia.org/wikipedia/commons/0/0f/Kitten_1370737.svg\"\r\n          width=\"30\"\r\n          height=\"30\"\r\n          alt=\"\"\r\n        />\r\n        Meow\r\n      </a>\r\n    </nav>\r\n  );\r\n};\r\n\r\nexport default Navbar;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport ListItems from \"./components/ListItems/\";\r\nimport Navbar from \"./components/Navbar\";\r\n\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <Navbar />\r\n      <Router>\r\n        <Switch>\r\n          <Route path=\"/\" exact component={ListItems} />\r\n        </Switch>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst rootElement = document.getElementById(\"root\");\r\nReactDOM.render(<App />, rootElement);\r\n"],"sourceRoot":""}